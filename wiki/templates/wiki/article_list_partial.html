{% load static %}
<div class="article-list">
  {% for article in articles %}
    <div class="card mb-3">
      <div class="card-body">
        <h2 class="card-title">
          <a href="{{ article.get_absolute_url }}">{{ article.title }}</a>
        </h2>
        <p class="text-muted">
          Категория: {{ article.category }} | 
          Автор: {{ article.author.email }} | 
          Опубликовано: {{ article.created_at|date:"d.m.Y" }}
        </p>
        <p>{{ article.content|truncatewords:30 }}</p>
        
        {% if article.file %}
          <p>
            <a href="{{ article.file.url }}" class="btn btn-sm btn-outline-secondary">
              <i class="fas fa-download"></i> Скачать файл
            </a>
          </p>
        {% endif %}
        
        {% if user.is_authenticated %}
          <form class="d-inline" hx-post="{% url 'wiki:api_bookmark_toggle' article.slug %}" 
                hx-target="#bookmark-status-{{ article.id }}" 
                hx-swap="outerHTML">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm {% if user in article.bookmarked_by.all %}btn-warning active{% else %}btn-outline-warning{% endif %}">
              <i class="fas fa-bookmark"></i> 
              {% if user in article.bookmarked_by.all %}Удалить из закладок{% else %}Добавить в закладки{% endif %}
            </button>
          </form>
          <span id="bookmark-status-{{ article.id }}"></span>
        {% endif %}
      </div>
    </div>
  {% empty %}
    <div class="alert alert-info">
      Нет опубликованных статей.
    </div>
  {% endfor %}
</div>

{% include 'wiki/components/pagination.html' %}